<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="generator" content="litedown 0.7">
<title></title>
<style type="text/css">
body {
  font-family: sans-serif;
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 1.5;
  print-color-adjust: exact;
  -webkit-print-color-adjust: exact;
}
body, .abstract, code, .footnotes, footer, #refs, .caption { font-size: .9em; }
li li { font-size: .95em; }
ul:has(li > input[type="checkbox"]) { list-style: none; padding-left: 1em; }
*, :before, :after { box-sizing: border-box; }
a { color: steelblue; }
pre, img { max-width: 100%; }
pre { white-space: pre-wrap; word-break: break-word; }
pre code { display: block; padding: 1em; overflow-x: auto; }
code { font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace; }
:not(pre, th) > code, code[class], div > .caption { background: #f8f8f8; }
pre > code:is(:not([class]), .language-plain, .language-none, .plain), .box, .figure, .table { background: inherit; border: 1px solid #eee; }
pre > code {
  &.message { border-color: #9eeaf9; }
  &.warning { background: #fff3cd; border-color: #fff3cd; }
  &.error { background: #f8d7da; border-color: #f8d7da; }
}
.fenced-chunk { border-left: 1px solid #666; }
.code-fence {
  opacity: .4;
  border: 1px dashed #666;
  border-left: 2px solid;
  &:hover { opacity: inherit; }
}
.box, .figure, .table, table { margin: 1em auto; }
div > .caption { padding: 1px 1em; }
.figure { p:has(img, svg), pre:has(svg) { text-align: center; } }
.flex-col { display: flex; justify-content: space-between; }
table {
  &:only-child:not(.table > *) { margin: auto; }
  th, td { padding: 5px; font-variant-numeric: tabular-nums; }
  thead, tfoot, tr:nth-child(even) { background: whitesmoke; }
  thead th { border-bottom: 1px solid #ddd; }
  &:not(.datatable-table) {
    border-top: 1px solid #666;
    border-bottom: 1px solid #666;
  }
}
blockquote {
  color: #666;
  margin: 0;
  padding: 1px 1em;
  border-left: .5em solid #eee;
}
hr, .footnotes::before { border: 1px dashed #ddd; }
.frontmatter { text-align: center; }
#TOC {
  a { text-decoration: none; }
  ul { list-style: none; padding-left: 1em; }
  & > ul { padding: 0; }
  ul ul { border-left: 1px solid lightsteelblue; }
}
.body h2 { border-bottom: 1px solid #666; }
.body .appendix, .appendix ~ h2 { border-bottom-style: dashed; }
.main-number::after { content: "."; }
span[class^="ref-number-"] { font-weight: bold; }
.ref-number-fig::after, .ref-number-tab::after { content: ":"; }
.cross-ref-chp::before { content: "Chapter "; }
.cross-ref-sec::before { content: "Section "; }
.cross-ref-fig::before, .ref-number-fig::before { content: "Figure "; }
.cross-ref-tab::before, .ref-number-tab::before { content: "Table "; }
.cross-ref-eqn::before, .MathJax_ref:has(mjx-mtext > mjx-c + mjx-c)::before { content: "Equation "; }
.abstract, #refs {
  &::before { display: block; margin: 1em auto; font-weight: bold; }
}
.abstract::before { content: "Abstract"; text-align: center; }
#refs::before { content: "Bibliography"; font-size: 1.5em; }
.ref-paren-open::before { content: "("; }
.ref-paren-close::after { content: ")"; }
.ref-semicolon::after { content: "; "; }
.ref-and::after { content: " and "; }
.ref-et-al::after { content: " et al."; font-style: italic; }
.footnote-ref a {
  &::before { content: "["; }
  &::after { content: "]"; }
}
section.footnotes {
  margin-top: 2em;
  &::before { content: ""; display: block; max-width: 20em; }
}
.fade {
  background: repeating-linear-gradient(135deg, white, white 30px, #ddd 32px, #ddd 32px);
  opacity: 0.6;
}

@media print {
  body { max-width: 100%; }
  tr, img { break-inside: avoid; }
}
@media only screen and (min-width: 992px) {
  body:not(.pagesjs) pre:has(.line-numbers):not(:hover) { white-space: pre; }
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@xiee/utils@1.14.14/css/prism-xcode.min.css">
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js" defer></script>
</head>
<body>
<div class="frontmatter">
</div>
<div class="body">
<h2>title: “ReproducibleResearch_CourseProject1”
author: “Author: sagiff”
date: “2025-09-18”
output: html_document</h2>
<p>[Assignment Description:]{.underline} This assignment makes use of data from a personal activity monitoring device. This device collects data at 5 minute intervals through out the day. The data consists of two months of data from an anonymous individual collected during the months of October and November, 2012 and include the number of steps taken in 5 minute intervals each day.</p>
<hr />
<h4 id="sec:loading-and-pre-processing-the-data-underline">[<strong>Loading and pre-processing the data:</strong>]{.underline}</h4>
<p>Load necessary libraries</p>
<pre><code class="language-r">  library(dplyr)
  library(ggplot2)
</code></pre>
<p>File existence check</p>
<pre><code class="language-r">  if(!file.exists(&quot;activity.csv&quot;)) {
    stop(paste(&quot;File does not exist:&quot;, &quot;activity.csv&quot;))
  }
</code></pre>
<pre><code>## Error: File does not exist: activity.csv
</code></pre>
<p>Read CSV</p>
<pre><code class="language-r">  activity &lt;- read.csv(&quot;activity.csv&quot;)
</code></pre>
<pre><code>## Warning in file(file, &quot;rt&quot;): cannot open file 'activity.csv': No such file or directory
</code></pre>
<pre><code>## Error in file(file, &quot;rt&quot;): cannot open the connection
</code></pre>
<p>Convert dates to class ‘Date’</p>
<pre><code class="language-r">  activity$date &lt;- as.Date(activity$date, format = &quot;%Y-%m-%d&quot;)
</code></pre>
<p>Convert interval time strings to total minutes</p>
<pre><code class="language-r">  convert_to_minutes &lt;- function(x) {
    if (nchar(x) &gt; 2) {
      hours &lt;- as.numeric(substr(x, 1, nchar(x) - 2))   ##Get hours - all digits up to the second-to-last
      minutes &lt;- as.numeric(substr(x, nchar(x) - 1, nchar(x)))    ##Get minutes - all digits from second-to-last and beyond
    } else {
      hours &lt;- 0
      minutes &lt;- as.numeric(x)
    }
    
    total_minutes &lt;- (hours * 60) + minutes   ##Calculate total minutes
    return(total_minutes)
  }

  activity$interval &lt;- sapply(activity$interval, convert_to_minutes)
</code></pre>
<hr />
<h4 id="sec:what-is-the-mean-total-number-of-steps-taken-per-day-underline">[<strong>What is the mean total number of steps taken per day?</strong>]{.underline}</h4>
<p>Summarize the data by date (calculate total steps per day, mean steps per day, and median steps per day)</p>
<pre><code class="language-r">  activity_summary &lt;- activity %&gt;% group_by(date) %&gt;% summarise(steps_total = as.numeric(sum(steps, na.rm = TRUE)), steps_mean = mean(steps, na.rm = TRUE), steps_median = median(steps, na.rm = TRUE))
</code></pre>
<p>Convert to data frame</p>
<pre><code class="language-r">  activity_summary &lt;- as.data.frame(activity_summary)
</code></pre>
<p>Report mean and median steps per day</p>
<pre><code class="language-r">  print(activity_summary[, c(1, 3, 4)])
</code></pre>
<pre><code>##          date steps_mean steps_median
## 1  2012-10-01        NaN           NA
## 2  2012-10-02  0.4375000            0
## 3  2012-10-03 39.4166667            0
## 4  2012-10-04 42.0694444            0
## 5  2012-10-05 46.1597222            0
## 6  2012-10-06 53.5416667            0
## 7  2012-10-07 38.2465278            0
## 8  2012-10-08        NaN           NA
## 9  2012-10-09 44.4826389            0
## 10 2012-10-10 34.3750000            0
## 11 2012-10-11 35.7777778            0
## 12 2012-10-12 60.3541667            0
## 13 2012-10-13 43.1458333            0
## 14 2012-10-14 52.4236111            0
## 15 2012-10-15 35.2048611            0
## 16 2012-10-16 52.3750000            0
## 17 2012-10-17 46.7083333            0
## 18 2012-10-18 34.9166667            0
## 19 2012-10-19 41.0729167            0
## 20 2012-10-20 36.0937500            0
## 21 2012-10-21 30.6284722            0
## 22 2012-10-22 46.7361111            0
## 23 2012-10-23 30.9652778            0
## 24 2012-10-24 29.0104167            0
## 25 2012-10-25  8.6527778            0
## 26 2012-10-26 23.5347222            0
## 27 2012-10-27 35.1354167            0
## 28 2012-10-28 39.7847222            0
## 29 2012-10-29 17.4236111            0
## 30 2012-10-30 34.0937500            0
## 31 2012-10-31 53.5208333            0
## 32 2012-11-01        NaN           NA
## 33 2012-11-02 36.8055556            0
## 34 2012-11-03 36.7048611            0
## 35 2012-11-04        NaN           NA
## 36 2012-11-05 36.2465278            0
## 37 2012-11-06 28.9375000            0
## 38 2012-11-07 44.7326389            0
## 39 2012-11-08 11.1770833            0
## 40 2012-11-09        NaN           NA
## 41 2012-11-10        NaN           NA
## 42 2012-11-11 43.7777778            0
## 43 2012-11-12 37.3784722            0
## 44 2012-11-13 25.4722222            0
## 45 2012-11-14        NaN           NA
## 46 2012-11-15  0.1423611            0
## 47 2012-11-16 18.8923611            0
## 48 2012-11-17 49.7881944            0
## 49 2012-11-18 52.4652778            0
## 50 2012-11-19 30.6979167            0
## 51 2012-11-20 15.5277778            0
## 52 2012-11-21 44.3993056            0
## 53 2012-11-22 70.9270833            0
## 54 2012-11-23 73.5902778            0
## 55 2012-11-24 50.2708333            0
## 56 2012-11-25 41.0902778            0
## 57 2012-11-26 38.7569444            0
## 58 2012-11-27 47.3819444            0
## 59 2012-11-28 35.3576389            0
## 60 2012-11-29 24.4687500            0
## 61 2012-11-30        NaN           NA
</code></pre>
<p>Plot a histogram of total number of steps taken each day</p>
<pre><code class="language-r">  with(activity_summary, hist(steps_total, breaks = 19, main = &quot;Total Steps&quot;, xlab = &quot;Total Steps per Day&quot;, ylab = &quot;Frequency&quot;, xaxt = &quot;n&quot;, yaxt = &quot;n&quot;))
  axis(2, at = seq(0, 10, by = 2), labels = FALSE)
  text(x = par(&quot;usr&quot;)[1] - 1000, y = seq(0, 10, by = 2), labels = seq(0, 10, by = 2), cex = 0.75, srt = 45, xpd = TRUE)
  axis(1, at = seq(0, 22000, by = 1000), labels = FALSE)
  text(x = seq(0, 22000, by = 1000), y = par(&quot;usr&quot;)[3] - 1.1, labels = seq(0, 22000, by = 1000), cex = 0.6, srt = 45, xpd = TRUE)
</code></pre>
<p>![plot of chunk Plot histogram of total steps per day](figure/Plot histogram of total steps per day-1.png)</p>
<hr />
<h4 id="sec:what-is-the-average-daily-activity-pattern-underline">[<strong>What is the average daily activity pattern?</strong>]{.underline}</h4>
<p>Summarize the data by 5-minute interval (calculate average number of steps across all days)</p>
<pre><code class="language-r">  activity_summary2 &lt;- activity %&gt;% group_by(interval) %&gt;% summarise(steps_mean = mean(steps, na.rm = TRUE))
</code></pre>
<p>Convert to data frame</p>
<pre><code class="language-r">  activity_summary2 &lt;- as.data.frame(activity_summary2)
</code></pre>
<p>Plot a time series plot of average steps taken across all days (y-axis) by interval (x-axis)</p>
<pre><code class="language-r">  par(mar = c(5, 4, 4, 2) + 6)
  with(activity_summary2, plot(interval, steps_mean, type = &quot;l&quot;, xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, main = &quot;&quot;, xlab = &quot;&quot;, ylab = &quot;&quot;)) 
  title(main = &quot;Average Steps (across all days) by Interval&quot;, line = 2, cex.main = 4)
  title(xlab = &quot;Interval (minutes)&quot;, ylab = &quot;Average Steps (all days)&quot;, line = 6, cex.lab = 3)
  axis(2, at = seq(0, 200, by = 20), labels = FALSE)
  text(x = par(&quot;usr&quot;)[1] - 15, y = seq(0, 200, by = 20), labels = seq(0, 200, by = 20), cex = 2, srt = 45, adj = 1.25, xpd = TRUE)
  axis(1, at = seq(0, 1440, by = 20), labels = FALSE)
  text(x = seq(0, 1440, by = 20), y = par(&quot;usr&quot;)[3] - 3, labels = seq(0, 1440, by = 20), cex = 1.75, srt = 45, adj = 1.25, xpd = TRUE)
  abline(v = activity_summary2$interval[which.max(activity_summary2$steps_mean)], col = &quot;red&quot;)
  text(x = 630, y = 207, label = &quot;Max Average = 206, Interval = 835&quot;, col = &quot;black&quot;, cex = 2)
</code></pre>
<p>![plot of chunk Plot time series of steps by interval](figure/Plot time series of steps by interval-1.png)</p>
<p>The 5-minute interval that contains the maximum number of steps across all days in the data set is at 835 minutes (at about 13:54)</p>
<hr />
<h4 id="sec:imputing-missing-values-underline">[<strong>Imputing missing values</strong>]{.underline}</h4>
<p>Calculate the total number of missing values in the data set</p>
<pre><code class="language-r">  missing_rows &lt;- activity %&gt;% group_by(date) %&gt;% summarise(missing_count = sum(is.na(steps)))
  result &lt;- missing_rows[missing_rows$missing_count == 288, ]
  sum(result$missing_count)
</code></pre>
<pre><code>## [1] 2304
</code></pre>
<p>Determine which days contain NA values</p>
<pre><code class="language-r">  print(result)
</code></pre>
<pre><code>## # A tibble: 8 × 2
##   date       missing_count
##   &lt;date&gt;             &lt;int&gt;
## 1 2012-10-01           288
## 2 2012-10-08           288
## 3 2012-11-01           288
## 4 2012-11-04           288
## 5 2012-11-09           288
## 6 2012-11-10           288
## 7 2012-11-14           288
## 8 2012-11-30           288
</code></pre>
<p>Use steps_mean (mean steps by interval) to impute missing data</p>
<pre><code class="language-r">  activity$steps_imputed &lt;- replace(activity$steps, is.na(activity$steps), activity_summary2$steps_mean)
</code></pre>
<p>Summarize the data by date (calculate total steps per day, mean steps per day, and median steps per day)</p>
<pre><code class="language-r">  activity_summary3 &lt;- activity %&gt;% group_by(date) %&gt;% summarise(steps_total = as.numeric(sum(steps_imputed, na.rm = TRUE)), steps_mean = mean(steps_imputed, na.rm = TRUE), steps_median = median(steps_imputed, na.rm = TRUE))
</code></pre>
<p>Convert to data frame</p>
<pre><code class="language-r">  activity_summary3 &lt;- as.data.frame(activity_summary3)
</code></pre>
<p>Report mean and median steps per day</p>
<pre><code class="language-r">  print(activity_summary3[, c(1, 3, 4)])
</code></pre>
<pre><code>##          date steps_mean steps_median
## 1  2012-10-01 31.4789645     27.80283
## 2  2012-10-02  0.4375000      0.00000
## 3  2012-10-03 39.4166667      0.00000
## 4  2012-10-04 42.0694444      0.00000
## 5  2012-10-05 46.1597222      0.00000
## 6  2012-10-06 53.5416667      0.00000
## 7  2012-10-07 38.2465278      0.00000
## 8  2012-10-08 31.4789645     27.80283
## 9  2012-10-09 44.4826389      0.00000
## 10 2012-10-10 34.3750000      0.00000
## 11 2012-10-11 35.7777778      0.00000
## 12 2012-10-12 60.3541667      0.00000
## 13 2012-10-13 43.1458333      0.00000
## 14 2012-10-14 52.4236111      0.00000
## 15 2012-10-15 35.2048611      0.00000
## 16 2012-10-16 52.3750000      0.00000
## 17 2012-10-17 46.7083333      0.00000
## 18 2012-10-18 34.9166667      0.00000
## 19 2012-10-19 41.0729167      0.00000
## 20 2012-10-20 36.0937500      0.00000
## 21 2012-10-21 30.6284722      0.00000
## 22 2012-10-22 46.7361111      0.00000
## 23 2012-10-23 30.9652778      0.00000
## 24 2012-10-24 29.0104167      0.00000
## 25 2012-10-25  8.6527778      0.00000
## 26 2012-10-26 23.5347222      0.00000
## 27 2012-10-27 35.1354167      0.00000
## 28 2012-10-28 39.7847222      0.00000
## 29 2012-10-29 17.4236111      0.00000
## 30 2012-10-30 34.0937500      0.00000
## 31 2012-10-31 53.5208333      0.00000
## 32 2012-11-01 31.4789645     27.80283
## 33 2012-11-02 36.8055556      0.00000
## 34 2012-11-03 36.7048611      0.00000
## 35 2012-11-04 31.4789645     27.80283
## 36 2012-11-05 36.2465278      0.00000
## 37 2012-11-06 28.9375000      0.00000
## 38 2012-11-07 44.7326389      0.00000
## 39 2012-11-08 11.1770833      0.00000
## 40 2012-11-09 31.4789645     27.80283
## 41 2012-11-10 31.4789645     27.80283
## 42 2012-11-11 43.7777778      0.00000
## 43 2012-11-12 37.3784722      0.00000
## 44 2012-11-13 25.4722222      0.00000
## 45 2012-11-14 31.4789645     27.80283
## 46 2012-11-15  0.1423611      0.00000
## 47 2012-11-16 18.8923611      0.00000
## 48 2012-11-17 49.7881944      0.00000
## 49 2012-11-18 52.4652778      0.00000
## 50 2012-11-19 30.6979167      0.00000
## 51 2012-11-20 15.5277778      0.00000
## 52 2012-11-21 44.3993056      0.00000
## 53 2012-11-22 70.9270833      0.00000
## 54 2012-11-23 73.5902778      0.00000
## 55 2012-11-24 50.2708333      0.00000
## 56 2012-11-25 41.0902778      0.00000
## 57 2012-11-26 38.7569444      0.00000
## 58 2012-11-27 47.3819444      0.00000
## 59 2012-11-28 35.3576389      0.00000
## 60 2012-11-29 24.4687500      0.00000
## 61 2012-11-30 31.4789645     27.80283
</code></pre>
<p>Plot a histogram of total number of steps taken each day</p>
<pre><code class="language-r">  with(activity_summary3, hist(steps_total, breaks = 19, main = &quot;Total Steps (with imputed data)&quot;, xlab = &quot;Total Steps per Day&quot;, ylab = &quot;Frequency&quot;, xaxt = &quot;n&quot;, yaxt = &quot;n&quot;))
  axis(2, at = seq(0, 18, by = 2), labels = FALSE)
  text(x = par(&quot;usr&quot;)[1] - 1000, y = seq(0, 18, by = 2), labels = seq(0, 18, by = 2), cex = 0.75, srt = 45, xpd = TRUE)
  axis(1, at = seq(0, 22000, by = 1000), labels = FALSE)
  text(x = seq(0, 22000, by = 1000), y = par(&quot;usr&quot;)[3] - 2, labels = seq(0, 22000, by = 1000), cex = 0.6, srt = 45, xpd = TRUE)
</code></pre>
<p>![plot of chunk Plot histogram of steps each day](figure/Plot histogram of steps each day-1.png)</p>
<hr />
<h4 id="sec:are-there-differences-in-activity-patterns-between-weekdays-and-weekends-underline">[<strong>Are there differences in activity patterns between weekdays and weekends?</strong>]{.underline}</h4>
<p>Create a new factor variable with two levels - “weekday” and “weekend”</p>
<pre><code class="language-r">  activity$day &lt;- weekdays(activity$date)
  activity &lt;- activity %&gt;% mutate(group = factor(ifelse(day %in% c(&quot;Monday&quot;, &quot;Tuesday&quot;, &quot;Wednesday&quot;, &quot;Thursday&quot;, &quot;Friday&quot;), &quot;Weekday&quot;, &quot;Weekend&quot;)))
</code></pre>
<p>Summarize the data by group (calculate total steps per day, mean steps per day)</p>
<pre><code class="language-r">  activity_summary4 &lt;- activity %&gt;% group_by(interval) %&gt;% reframe(steps_total = as.numeric(sum(steps_imputed, na.rm = TRUE)), steps_mean = mean(steps_imputed, na.rm = TRUE), group = group)
</code></pre>
<p>Convert to data frame</p>
<pre><code class="language-r">  activity_summary4 &lt;- as.data.frame(activity_summary4)
</code></pre>
<p>Create a panel plot containing a time series plot of the 5-minute interval (x-axis) and avg. steps across all week/weekend days (y-axis)</p>
<pre><code class="language-r">  g &lt;- ggplot(activity_summary4, aes(interval, steps_mean))
  g + geom_line() + facet_grid(rows = vars(group)) + facet_wrap(vars(group), axes = &quot;all&quot;, nrow = 2, strip.position = &quot;right&quot;) + scale_x_continuous(breaks = seq(0, 1500, by = 20), labels = seq(0, 1500, by = 20)) + theme(axis.text.x = element_text(size = 12, angle = 45, hjust = 1)) + scale_y_continuous(breaks = seq(0, 200, by = 20), labels = seq(0, 200, by = 20)) + theme(axis.text.y = element_text(size = 12, angle = 45, hjust = 1), strip.text = element_text(size = 16)) + labs(title = &quot;Average Steps (across all days) by Interval&quot;, subtitle = &quot;Weekday Compared to Weekend&quot;, x = &quot;Interval (minutes)&quot;, y = &quot;Average Steps (all days)&quot;) + theme(plot.title = element_text(size = 20, hjust = 0.5), plot.subtitle = element_text(size = 18, hjust = 0.5), axis.title.x = element_text(size = 14), axis.title.y = element_text(size = 14))
</code></pre>
<p>![plot of chunk Plot interval and steps across days](figure/Plot interval and steps across days-1.png)</p>
</div>
</body>
</html>
